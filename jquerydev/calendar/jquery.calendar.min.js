!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a():a(jQuery)}(function(a){"use strict";function j(a){var b=Math.random().toString(36).substr(2);return("string"==typeof a?a:"")+b}function k(a){return"[object Date]"===e.call(a)}function l(a,b){var c=a,d=b;return k(a)&&(c=q(a,"",6).match(/\d/g).join("")),k(b)&&(d=q(b,"",6).match(/\d/g).join("")),c-d}function m(a,b){var c=a,d=b;return k(a)&&(c=q(a,"",3)),k(b)&&(d=q(b,"",3)),c-d}function n(a){return k(a)?0===m(a,new Date):!1}function o(a){var b=new Date;if(!a)return b;var c=d.call(a,/\d+/g).concat([0,0,0,0,0,0,0]);return c[0].length>4&&(c=[c[0].substr(0,4),c[0].substr(4,2),c[0].substr(6,2)].concat(c.slice(1))),c[1]>0&&(c[1]=c[1]-1),f.apply(b,c.slice(0,3)),g.apply(b,c.slice(3,7)),b}function p(a){return a+="",2===a.length?a:"0"+a}function q(a,b,c){a=k(a)?a:new Date,b=void 0==b?"-":b,c=void 0==c?3:c,(0>c||c>7)&&(c=3);var d=[a.getFullYear(),b+p(a.getMonth()+1),b+p(a.getDate())," "+p(a.getHours()),":"+p(a.getMinutes()),":"+p(a.getSeconds()),"."+a.getMilliseconds()];return d.slice(0,c).join("")}function r(a){return a&&a.nodeName&&"INPUT"===a.nodeName.toUpperCase()&&"TEXT"===a.type.toUpperCase()}function s(a){var b=Math.floor(a/10);return b+"0"+"-"+b+"9"}function t(a){var b=Math.floor(a/100);return b+"00"+"-"+b+"99"}function u(a){this.init(a)}function v(b,c,d){var e=b.offset(),f=b.outerHeight(),g=b.outerWidth(),h=a(window),i=h.outerHeight(),j=h.outerWidth(),k=e.top-h.scrollTop(),l={position:"absolute",zIndex:d};i/2>k?(l.top=e.top+f+1+"px",l.bottom="auto",e.left>j/2?(l.right=j-g-e.left+"px",l.left="auto"):(l.right="auto",l.left=e.left+"px")):(l.top="auto",l.bottom=i-e.top+1+"px",e.left>j/2?(l.right=j-g-e.left+"px",l.left="auto"):(l.right="auto",l.left=e.left+"px")),c.css(l)}function w(b,c){this.element=b,this.$element=a(b),this.options=c,this.init()}function x(b,c,d){this.element={start:b,end:c},this.options=a.extend({},h,d),this.touchable=d.touchable,void 0==d.touchable&&(this.touchable=!0),this.options.hasSiblings=!0,this.init()}function y(){a(".calendar-closable.open").removeClass("open"),a(".calendar-pair").removeClass("open")}a.HjxCtrl||(a.HjxCtrl={}),a.HjxCtrl.calendar=!1,a.HjxCtrl.setCalendar=function(){a.HjxCtrl.calendar=!0},a.HjxCtrl.clearCalendar=function(){a.HjxCtrl.calendar=!1},a.HjxCtrl.getCalendar=function(){return a.HjxCtrl.calendar};var b="calendar-api",c=Array.prototype.slice,d=String.prototype.match,e=Object.prototype.toString,f=Date.prototype.setFullYear,g=Date.prototype.setHours,h={style:"",separator:"-",size:3,active:!1,closable:!0,enable:[void 0,void 0],zIndex:798,date:null,weekStart:0,weekText:"\u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d",monthText:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708",timeText:"\u65f6\u5206\u79d2",time:!1,todayBtn:!1,todayText:"\u4eca\u5929",clearBtn:!1,clearText:"\u6e05\u9664",sureText:"\u786e\u5b9a",clear:null,after:null,dateClick:null,dateMouseover:null,dateMouseleave:null},i={month:"VIEW_MODE_MONTH",year:"VIEW_MODE_YEAR",ten:"VIEW_MODE_TEN",century:"VIEW_MODE_CENTURY"};u.prototype={constructor:u,init:function(a){this.d=k(a)?new Date(a):o(a),this.year=this.d.getFullYear()+"",this.month=p(this.d.getMonth()+1),this.date=p(this.d.getDate())},toStr:function(a,b){return q(this.d,a,b)},count:function(){var a=new Date(this.year,this.month,0);return a.getDate()},firstDay:function(){var a=new Date(this.year,this.month-1,1);return a.setDate(1),a.getDay()},prev:function(a){a||(a=i.month);var b=null;switch(a){case i.month:b=new Date(this.year,this.month-1,0);break;case i.year:b=new Date(this.year-1,0,1),b.setFullYear(this.year-1);break;case i.ten:b=new Date(this.year-10,0,1),b.setFullYear(this.year-10);break;case i.century:b=new Date(this.year-100,0,1),b.setFullYear(this.year-100)}return new u(b)},next:function(a){a||(a=i.month);var b=null;switch(a){case i.month:b=new Date(this.year,this.month,1);break;case i.year:b=new Date(this.year- -1,0,1);break;case i.ten:b=new Date(this.year- -10,0,1);break;case i.century:b=new Date(this.year- -100,0,1)}return new u(b)}},w.prototype={constructor:w,isText:!0,init:function(){if(this.isText=r(this.element),this.isText?this.element.value&&(this.calendar=new u(this.element.value)):this.calendar=new u(this.options.date||new Date),this.options.time&&(this.isText&&this.calendar||this.options.hasSiblings&&this.options.pairTarget.val())){var a=q(this.calendar.d,"",6).match(/\d/g).join("");this.hms=a.substring(8),this.ymd=a.substr(0,8)}this.minDate=this.options.enable[0],this.maxDate=this.options.enable[1],this.wrap()},wrap:function(){var b=j("calendar"),c=['<div class="calendar" id="'+b+'">',' <div class="calendar-top"></div>',' <div class="calendar-body"></div>',' <div class="calendar-foot"></div>',"</div>"];this.isText?a("body").append(c.join("")):this.$element.append(c.join("")),this.$wrap=a("#"+b),this.$top=this.$wrap.find(".calendar-top"),this.$body=this.$wrap.find(".calendar-body"),this.$foot=this.$wrap.find(".calendar-foot"),this.options.closable&&this.$wrap.addClass("calendar-closable"),this.options.style&&this.$wrap.addClass("calendar-theme-"+this.options.style),this.options.todayBtn&&this.addToday(),this.options.clearBtn&&this.addClear(),this.options.time&&this.addTime(),this.options.active&&this.open(),this.listen()},addTime:function(){var a=['<div class="calendar-time">',' <div class="calendar-time-box calendar-hour">','  <div class="calendar-time-minus">-</div>','  <input type="text" maxlength="2" value="'+(this.hms?this.hms.substr(0,2):"00")+'" readonly="readonly"/>','  <div class="calendar-time-plus">+</div>',"  <span>"+this.options.timeText.charAt(0)+"</span>"," </div>",' <div class="calendar-time-box calendar-minute">','  <div class="calendar-time-minus">-</div>','  <input type="text" maxlength="2" value="'+(this.hms?this.hms.substr(2,2):"00")+'" readonly="readonly"/>','  <div class="calendar-time-plus">+</div>',"  <span>"+this.options.timeText.charAt(1)+"</span>"," </div>",' <div class="calendar-time-box calendar-second">','  <div class="calendar-time-minus">-</div>','  <input type="text" maxlength="2" value="'+(this.hms?this.hms.substr(4,2):"00")+'" readonly="readonly"/>','  <div class="calendar-time-plus">+</div>',"  <span>"+this.options.timeText.charAt(2)+"</span>"," </div>","</div>"];this.$foot.append(a.join("")),this.listenTimes()},listenTimes:function(){var c,d,b=this,e="000000",f=0,g=0,h="000000",i=this.$foot.find(".calendar-time-box "),j=this.$foot.find(".calendar-time-plus"),k=this.$foot.find(".calendar-time-minus");i.off("mousewheel.control-times"),j.off("click.control-time"),k.off("click.control-time"),this.minDate&&(c=q(this.minDate,"",6).match(/\d/g).join(""),f=c.substr(0,8),e=c.substring(8)),this.maxDate&&(d=q(this.maxDate,"",6).match(/\d/g).join(""),g=d.substr(0,8),h=d.substring(8)),i.on("mousewheel.control-times",function(c){if(!("deltaY"in c))return!0;var d=a(this),i=d.find("input")[0];c.deltaY>0?b.reduceTimes(i,d,f,e):b.addTimes(i,d,g,h),c.preventDefault()}),j.on("click.control-time",function(){var c=a(this),d=c.parent(".calendar-time-box"),e=d.find("input")[0];b.addTimes(e,d,g,h)}),k.on("click.control-time",function(){var c=a(this),d=c.parent(".calendar-time-box"),g=d.find("input")[0];b.reduceTimes(g,d,f,e)})},addTimes:function(a,b,c,d){var e=0===this.ymd-c;if(e&&this.hms-d>0)return!1;if(b.hasClass("calendar-hour")){var i=1*a.value;if(23>i){if(e&&d.substr(0,2)-i<=0)return!1;a.value=p(i+1)}}else if(b.hasClass("calendar-minute")){var i=1*a.value;if(e&&d.substr(2,2)-i<=0)return!1;59>i&&(a.value=p(i+1))}else if(b.hasClass("calendar-second")){var i=1*a.value;if(e&&d.substr(4,2)-i<=0)return!1;59>i&&(a.value=p(i+1))}this.isText&&this.$element.val()&&this.ymd?this.set(this.ymd):this.options.hasSiblings&&this.options.pairTarget.val()&&this.ymd&&this.set(this.ymd)},reduceTimes:function(a,b,c,d){var e=0===this.ymd-c;if(e&&this.hms-d<=0)return!1;if(b.hasClass("calendar-hour")){var f=1*a.value;if(f>0){if(e&&d.substr(0,2)-f>=0)return!1;a.value=p(f-1)}}else if(b.hasClass("calendar-minute")){var f=1*a.value;if(e&&d.substr(2,2)-f>=0)return!1;f>0&&(a.value=p(f-1))}else if(b.hasClass("calendar-second")){var f=1*a.value;if(e&&d.substr(4,2)-f>=0)return!1;f>0&&(a.value=p(f-1))}this.isText&&this.$element.val()&&this.ymd?this.set(this.ymd):this.options.hasSiblings&&this.options.pairTarget.val()&&this.ymd&&this.set(this.ymd)},addToday:function(){var a='<span class="calendar-btn calendar-today">'+this.options.todayText+"</span>";this.$foot.append(a)},addClear:function(){var a='<span class="calendar-btn calendar-clear">'+this.options.clearText+"</span>";this.$foot.append(a)},listen:function(){var b=this;this.isText&&this.$element.on("click.toggle-calendar",function(){b.$wrap.hasClass("open")?y():(y(),b.open()),a.HjxCtrl.setCalendar()}),this.$wrap.on("click.stop-close-calendar",function(a){b.$wrap.hasClass("calendar-closable")&&a.stopPropagation()}),this.$top.on("click.show-prev",".calendar-left",function(){b.viewCalendar=b.viewCalendar.prev(b.viewMode),b.change()}).on("click.show-next",".calendar-right",function(){b.viewCalendar=b.viewCalendar.next(b.viewMode),b.change()}).on("click.show-parent",".calendar-text",function(){b.parent()}),this.$body.on("click.show-month",".calendar-cell-month",function(){b.viewMode=i.month;var c=new Date(b.viewCalendar.year,a(this).data("month"),1);b.viewCalendar=new u(c),b.change()}).on("click.show-year",".calendar-cell-year",function(){b.viewMode=i.year;var c=new Date(a(this).data("year"),0,1);b.viewCalendar=new u(c),b.change()}).on("click.show-ten",".calendar-cell-ten",function(){b.viewMode=i.ten;var c=new Date(a(this).data("ten"),0,1);b.viewCalendar=new u(c),b.change()}).on("click.date-click",".calendar-cell-day",function(){var c=a(this),d=o(c.data("date"));b.dateClick(d,c)}),a.isFunction(this.options.dateMouseover)&&this.$body.on("mouseover.date-mouseover",".calendar-cell-day",function(){var c=a(this),d=o(c.data("date"));b.options.dateMouseover(d,c)}),a.isFunction(this.options.dateMouseleave)&&this.$body.on("mouseleave.date-mouseleave",".calendar-cell-day",function(){var c=a(this),d=o(c.data("date"));b.options.dateMouseleave(d,c)}),this.$foot.on("click.select-today",".calendar-today",function(){b.set(new Date).close()}).on("click.clear-calendar",".calendar-clear",function(){b.clear().close()})},change:function(){switch(this.viewMode){case i.month:this.month();break;case i.year:this.year();break;case i.ten:this.tenYears();break;case i.century:this.century()}},parent:function(){switch(this.viewMode){case i.month:this.viewMode=i.year,this.change();break;case i.year:this.viewMode=i.ten,this.change();break;case i.ten:this.viewMode=i.century,this.change();break;case i.century:}},top:function(){var a=this.viewCalendar.toStr("-",2);switch(this.viewMode){case i.month:break;case i.year:a=this.viewCalendar.year;break;case i.ten:a=s(this.viewCalendar.year);break;case i.century:a=t(this.viewCalendar.year)}var b=['<span class="calendar-left">',"<span></span><em></em>","</span>",'<div class="calendar-text">'+a+"</div>",'<span class="calendar-right">',"<span></span><em></em>","</span>"];this.$top.html(b.join(""))},month:function(){this.viewMode=i.month,this.top();var a=this,b=[];b[0]='<ul class="calendar-week">'+this.week().join("")+"</ul>",b[1]='<ul class="calendar-month">';for(var c=this.viewCalendar.count(),d=this.viewCalendar.firstDay(),e=this.viewCalendar.toStr("",2),f=function(){var b=[1,2,3,4,5,6,7,1,2,3,4,5,6,7];return b.slice(6-a.options.weekStart).slice(0,7)}(),g=this.viewCalendar.prev(),h=f[d],j=g.count(),k=j-h+1;j>=k;k++)b.push('<li class="calendar-cell-ignore">'+k+"</li>");for(k=1;c>=k;k++)b.push(this.day(e,k));var l=42-c-h;for(k=1;l>=k;k++)b.push('<li class="calendar-cell-ignore">'+k+"</li>");b.push("</ul>"),this.$body.html(b.join("")),this.after()},day:function(a,b){var c=a+p(b),d="calendar-cell-day";return this.minDate&&m(c,this.minDate)<0&&(d="calendar-cell-ignore"),this.maxDate&&m(c,this.maxDate)>0&&(d="calendar-cell-ignore"),'<li class="'+d+'" data-date="'+c+'">'+b+"</li>"},after:function(){var b=this.options.after||function(){},c=this.viewCalendar.d,d=null,e=this.viewCalendar.year,f=this.viewCalendar.month,g=this;a.isFunction(this.options.after)&&(d=[]),this.$body.find("[data-date]").each(function(b){var e=a(this);c.setDate(b+1),d&&d.push({date:new Date(c),target:e}),n(c)&&e.addClass("calendar-cell-today"),g.calendar&&g.isText&&0===m(c,g.calendar.d)&&e.addClass("calendar-cell-selected")}),b(e,f,d)},week:function(){return a.map(this.options.weekText.split(/\s+/),function(a){return"<li>"+a+"</li>"})},year:function(){this.top();var b="calendar-cell-month",c=a.map(this.options.monthText.split(/\s+/),function(a,c){return'<div class="'+b+'" data-month="'+c+'">'+a+"</div>"});this.$body.html(c.join(""))},tenYears:function(){var a=Math.floor(this.viewCalendar.year/10);this.top();for(var f,g,b=""+a+0-1,c=[],d=0,e=12;e>d;d++)f="calendar-cell-year",g=b+d,(0===d||11===d)&&(f+=" calendar-cell-ignore"),c.push('<div class="'+f+'" data-year="'+g+'">'+g+"</div>");this.$body.html(c.join(""))},century:function(){var a=Math.floor(this.viewCalendar.year/100);this.top();for(var f,g,h,b=""+a+"00"-10,c=[],d=0,e=12;e>d;d++)f="calendar-cell-ten",(0===d||11===d)&&(f+=" calendar-cell-ignore"),g=b+10*d,h="<p>"+g+"-</p><p>"+(g+9)+"</p>",c.push('<div class="'+f+'" data-ten="'+g+'">'+h+"</div>");this.$body.html(c.join(""))},dateClick:function(a,b){var c=this.options.dateClick;this.isText&&(this.set(a),this.close()),"function"==typeof c&&c(a,b)},getErrors:function(a){var b=0,c=0;return k(this.minDate)&&(b=m(a,this.minDate)),k(this.maxDate)&&(c=m(this.maxDate,a)),[b,c]},enable:function(b,c,d){if("boolean"!==a.type(b)&&(d=c,c=b,b=!1),b?(this.minDate=c,this.maxDate=d):(k(c)&&(this.minDate=c),k(d)&&(this.maxDate=d)),this.calendar&&this.getErrors(this.calendar.d).join("").indexOf("-")>-1&&this.clear(),!this.$wrap.hasClass("open"))return this;var e=this.viewCalendar.d,f=this.getErrors(e);return f[0]<0&&(this.viewCalendar=new u(this.minDate)),f[1]<0&&(this.viewCalendar=new u(this.maxDate)),this.viewMode===i.month&&this.month(),this.listenTimes(),this},clear:function(){return this.calendar=null,this.isText&&(this.element.value=""),this.options.hasSiblings&&this.options.pairTarget.val(""),this.$wrap.hasClass("open")&&this.$body.find(".calendar-cell-selected").removeClass("calendar-cell-selected"),this.options.time&&this.$foot.find(".calendar-time").find("input").val("00"),(this.options.clear||function(){})(),this},set:function(b){if(!b)return this;if(k(b)||(b=o(b)),this.options.time){var c=this.$foot.find(".calendar-time").find("input");b.setHours(c[0].value),b.setMinutes(c[1].value),b.setSeconds(c[2].value),this.minDate&&l(this.minDate,b)>0&&(b=new Date(this.minDate)),this.maxDate&&l(b,this.maxDate)>0&&(b=new Date(this.maxDate)),c[0].value=p(b.getHours()),c[1].value=p(b.getMinutes()),c[2].value=p(b.getSeconds())}var d=q(b,"",6).match(/\d/g).join("");this.hms=d.substring(8),this.ymd=d.substr(0,8),this.calendar=new u(b);var e="calendar-cell-selected";if(this.isText&&(this.element.value=q(b,this.options.separator,this.options.size)),this.options.hasSiblings&&(this.options.pairTarget.val(q(b,this.options.separator,this.options.size)),this.options.enable(b)),this.$wrap.hasClass("open")){var f=this.viewCalendar.d,g=this;this.$body.find("."+e).removeClass(e),this.$body.find("[data-date]").each(function(b){f.setDate(b+1),0===m(f,g.calendar.d)&&a(this).addClass(e)})}return this},open:function(){var a=null;a=this.calendar?this.calendar.d:new Date,this.viewCalendar=new u(a),this.viewMode=i.month;var b=this.getErrors(a),c=b[0]>-1,d=b[1]>-1;return this.$wrap.addClass("open"),this.isText&&v(this.$element,this.$wrap,this.options.zIndex),this.options.time&&(this.$foot.find(".calendar-hour").val(p(a.getHours())),this.$foot.find(".calendar-minute").val(p(a.getMinutes())),this.$foot.find(".calendar-second").val(p(a.getSeconds()))),c||(this.viewCalendar=new u(this.minDate)),d||(this.viewCalendar=new u(this.maxDate)),this.month(),this},close:function(){return this.$wrap.removeClass("open"),this},noop:function(){return this}},a.fn.calendar=function(){var d=c.call(arguments,0),e=d[0],f=this.data(b),g="string"==typeof e,i="noop";return g&&(i=e,e={}),f||(e=a.extend({},h,e||{}),f=new w(this[0],e),this.data(b,f)),g?f[i].apply(f,d.slice(1)):f},x.prototype={constructor:x,init:function(){var b=this,c=j("calendarPair"),d=['<div class="calendar-pair" id="'+c+'">',' <div class="calendar-start"></div>',' <div class="calendar-end"></div>',' <div class="calendar-btn calendar-sure">',this.options.sureText+"</div>","</div>"];a("body").append(d.join(""));var e=a("#"+c),f=this.element.start.val(),g=this.element.end.val(),h=this.options.enable,i=e.find(".calendar-start"),k=e.find(".calendar-end"),l=this.options.scope,n=f?o(f):void 0,p=g?o(g):void 0,q=a.extend(!0,{},this.options,{date:n,active:!0,closable:!1,pairTarget:b.element.start,after:function(c,d,e){var f=b.element.start.val();f&&(f=o(f),a.each(e,function(a,b){0===m(b.date,f)&&b.target.addClass("calendar-cell-selected")}))},clear:function(){k.calendar("enable",!0,h[0],h[1])},dateClick:function(a){i.calendar("set",a)},enable:function(c){var d=h[1];a.isFunction(l)&&(d=l(new Date(c))[1]),b.touchable||c.setDate(c.getDate()+1),k.calendar("enable",c,d)}}),r=a.extend(!0,{},this.options,{date:p,active:!0,closable:!1,pairTarget:b.element.end,after:function(c,d,e){var f=b.element.end.val();f&&(f=o(f),a.each(e,function(a,b){0===m(b.date,f)&&b.target.addClass("calendar-cell-selected")}))},clear:function(){i.calendar("enable",!0,h[0],h[1])},dateClick:function(a){k.calendar("set",a)},enable:function(c){var d=h[0];a.isFunction(l)&&(d=l(new Date(c))[0]),b.touchable||c.setDate(c.getDate()-1),i.calendar("enable",d,c)}});f&&(r.enable[0]=o(f)),g&&(q.enable[1]=o(g)),i.calendar(q),k.calendar(r);var s='<div class="calendar-btn calendar-clear">'+this.options.clearText+"</div>";i.append(s),k.append(s),e.on("click.stop-close-calendar",function(a){a.stopPropagation()}),e.find(".calendar-sure").on("click.close-calendar-pair",function(){e.removeClass("open")}),this.element.start.on("click.toggle-calendar-pair",function(){e.hasClass("open")?y():(y(),e.addClass("open"),v(a(this),e,b.options.zIndex)),a.HjxCtrl.setCalendar()}),this.element.end.on("click.toggle-calendar-pair",function(){e.hasClass("open")?y():(y(),e.addClass("open"),v(a(this),e,b.options.zIndex)),a.HjxCtrl.setCalendar()}),i.find(".calendar-clear").on("click.calendar-clear",function(){i.calendar("clear")}),k.find(".calendar-clear").on("click.calendar-clear",function(){k.calendar("clear")})}},a.calendarPair=function(a){return new x(a.start,a.end,a)},a(document).on("click.calendar-api",function(){a.HjxCtrl.getCalendar()||y(),a.HjxCtrl.clearCalendar()})});